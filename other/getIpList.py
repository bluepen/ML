import requests
from other import getUser_Agent
from lxml import etree
import random

headers = getUser_Agent.getUser_Agent()

def getIpList(url):
    proxy = {}
    resp = requests.get(url=url,headers=headers)
    resp = resp.content.decode("utf-8")
    tree = etree.HTML(resp)
    ips = tree.xpath("//td[@data-title='IP']/text()")
    ports = tree.xpath("//td[@data-title='PORT']/text()")
    for ip,port in zip(ips,ports):
        proxy[ip] = port

    return proxy

def writeInfoToFile(dict):
    with open("ip_list.txt",'a+') as file:
        for ip,port in dict.items():

            file.write("'" + str(ip) + ":" + str(port) + "'," +'\n')
            print(str(ip) + ":" + str(port) + "have been writen into the file")


def readIpFromFile(filename):
    with open(filename,"r") as file:
        ips = file.readlines()
        for ip in ips:
            print(ip,)

def getProxy():
    ip_port = [
        '111.177.172.230:9999',
        '202.104.150.130:58729',
        '1.198.72.239:9999',
        '115.239.24.107:9999',
        '111.230.237.187:8118',
        '117.90.137.229:9000',
        '1.197.204.220:9999',
        '218.87.239.248:9999',
        '123.163.118.172:9999',
        '124.94.197.81:9999',
        '111.77.20.179:9000',
        '1.197.204.215:9999',
        '183.129.244.16:13357',
        '163.204.240.125:9999',
        '47.94.104.204:8118',
        '114.235.23.78:9000',
        '120.83.103.145:9999',
        '116.209.55.248:9999',
        '60.188.60.29:9000',
        '113.121.147.9:9999',
        '144.255.14.7:9999',
        '121.233.251.147:9999',
        '117.41.38.19:9000',
        '117.63.8.118:9999',
        '140.143.246.163:8080',
        '123.163.116.7:9999',
        '162.105.95.34:1080',
        '222.135.92.68:38094',
        '163.204.246.18:9999',
        '114.234.80.136:9000',
        '221.224.136.211:35101',
        '106.86.208.98:51230',
        '49.86.180.52:9999',
        '115.221.121.181:9999',
        '180.118.73.47:9999',
        '183.158.203.44:9000',
        '121.233.207.210:9999',
        '111.177.165.32:9999',
        '116.209.53.59:9999',
        '112.16.172.107:54679',
        '111.77.22.167:9000',
        '111.177.175.182:9999',
        '113.105.203.94:3128',
        '116.209.57.229:9999',
        '182.87.39.84:9000',
        '117.95.200.43:9999',
        '117.90.252.224:9000',
        '171.12.115.4:9999',
        '58.62.238.150:50368',
        '180.118.128.244:9000',
        '117.91.232.131:9999',
        '116.209.59.223:9999',
        '36.26.205.143:9999',
        '125.123.137.218:9999',
        '117.90.137.153:9000',
        '193.112.88.59:10001',
        '111.177.163.107:9999',
        '180.125.70.78:9999',
        '117.90.4.230:9999',
        '116.209.58.199:9999',
        '121.225.25.83:3128',
        '111.181.34.110:9999',
        '116.209.54.69:9999',
        '36.110.234.244:80',
        '125.122.151.9:9000',
        '171.80.152.59:9999',
        '116.210.36.238:9999',
        '61.164.39.68:53281',
        '116.209.53.42:9999',
        '124.93.201.59:42672',
        '183.129.244.16:11723',
        '125.123.142.120:9999',
        '117.90.252.191:9000',
        '222.92.112.66:8080',
        '36.7.128.146:44473',
        '116.209.54.138:9999',
        '180.168.13.26:8000',
        '1.197.203.179:9999',
        '222.186.129.51:9001',
        '115.193.98.189:9000',
        '163.204.245.11:9999',
        '118.182.33.8:42801',
        '121.232.148.35:9000',
        '117.90.137.49:9999',
        '115.223.253.241:9000',
        '180.117.97.31:9999',
        '113.122.169.100:9999',
        '111.177.170.145:9999',
        '61.183.176.122:57210',

    ]
    return {"https":"http://" + ip_port[random.randint(0,len(ip_port)-1)]}


if __name__ == '__main__':
    # url = "https://www.kuaidaili.com/free/inha/{}/"
    # for page in range(40):
    #     s_url = url.format(str(page))
    #     _dict = getIpList(s_url)
    #     writeInfoToFile(_dict)
    # filename = 'ip_list.txt'
    # readIpFromFile(filename)
    for i in range(10):
        print(getProxy())


